var u=Object.defineProperty;var m=(t,e,n)=>e in t?u(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var a=(t,e,n)=>(m(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();class p{constructor(e){a(this,"storageKey");a(this,"shortenedLinks",[]);this.storageKey=e,this.shortenedLinks=this.loadShortenedLinks()}getShortenedLinks(){return this.shortenedLinks.slice(0)}addShortenedLink(e){return this.shortenedLinks.unshift(e),this.save(),this.getShortenedLinks()}removeShortenedLink(e){return this.shortenedLinks=this.shortenedLinks.filter(({id:n})=>n!==e),this.save(),this.getShortenedLinks()}loadShortenedLinks(){const e=localStorage.getItem(this.storageKey);return e?JSON.parse(e):[]}save(){localStorage.setItem(this.storageKey,JSON.stringify(this.shortenedLinks))}}let l;const g=new Uint8Array(16);function y(){if(!l&&(l=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!l))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return l(g)}const o=[];for(let t=0;t<256;++t)o.push((t+256).toString(16).slice(1));function v(t,e=0){return(o[t[e+0]]+o[t[e+1]]+o[t[e+2]]+o[t[e+3]]+"-"+o[t[e+4]]+o[t[e+5]]+"-"+o[t[e+6]]+o[t[e+7]]+"-"+o[t[e+8]]+o[t[e+9]]+"-"+o[t[e+10]]+o[t[e+11]]+o[t[e+12]]+o[t[e+13]]+o[t[e+14]]+o[t[e+15]]).toLowerCase()}const f=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),c={randomUUID:f};function k(t,e,n){if(c.randomUUID&&!e&&!t)return c.randomUUID();t=t||{};const r=t.random||(t.rng||y)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(let i=0;i<16;++i)e[n+i]=r[i];return e}return v(r)}async function b(t){try{const e=await fetch(`https://api.shrtco.de/v2/shorten?url=${t}`);if(!e.ok)throw Error("Please add a valid link");const n=await e.json();return[{id:k(),original:t,short:n.result.full_short_link2},null]}catch(e){return[null,e]}}class L{constructor(e){a(this,"urlRegex",new RegExp(/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,4}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/i));a(this,"storage");a(this,"menu");a(this,"menuBtn");a(this,"container");a(this,"form");a(this,"input");this.storage=e,this.menu=document.querySelector("#menu"),this.menuBtn=document.querySelector("#menu-btn"),this.container=document.querySelector("#shortened-links"),this.form=document.querySelector("#shorten-form"),this.input=this.form.querySelector("input")}init(){this.menuBtn.addEventListener("click",this.toggleMobileMenu.bind(this)),this.input.addEventListener("input",this.validateLinkInput.bind(this)),this.form.addEventListener("submit",this.handleFormSubmit.bind(this)),this.displayShortenedLinks()}toggleMobileMenu(){this.menu.classList.toggle("hidden")}async handleFormSubmit(e){if(e.preventDefault(),!this.validateLinkInput())return;const n=this.input.value.trim(),[r,i]=await b(n);if(!r){this.markAsInvalid(this.input,i.message);return}this.form.reset(),this.storage.addShortenedLink(r),this.displayShortenedLink(r)}validateLinkInput(){const e=this.input.value.trim();return e.length<1||!this.urlRegex.test(e)?(this.markAsInvalid(this.input,"Please add a valid link"),!1):(this.markAsValid(this.input),!0)}markAsInvalid(e,n){e.setAttribute("data-invalid","");const r=e.nextElementSibling;r&&(r.textContent=n)}markAsValid(e){e.removeAttribute("data-invalid");const n=e.nextElementSibling;n&&(n.textContent="")}displayShortenedLinks(){const e=this.storage.getShortenedLinks();this.container.append(...e.map(n=>this.createShortenedLinkElement(n)))}displayShortenedLink(e){this.container.prepend(this.createShortenedLinkElement(e))}createShortenedLinkElement(e){const n=document.createElement("div");n.dataset.id=e.id,n.className="shortened-link flex flex-col md:flex-row md:items-center bg-white rounded-md text-base md:text-lg text-very-dark-blue",n.insertAdjacentHTML("afterbegin",`<p class="p-4 md:p-6 overflow-hidden whitespace-nowrap text-ellipsis md:flex-1">
      ${e.original}
    </p>
    <hr class="text-gray opacity-70 md:hidden" />`);const r=document.createElement("div");r.className="flex flex-col gap-4 md:flex-row md:items-center md:gap-6 p-4 md:p-6",r.insertAdjacentHTML("afterbegin",`<a
        target="_blank"
        href="${e.short}"
        class="text-cyan overflow-hidden whitespace-nowrap text-ellipsis">
        ${e.short}
      </a>`),n.appendChild(r);const i=document.createElement("div");i.className="flex justify-end gap-3",r.appendChild(i);const s=document.createElement("button");s.textContent="Copy",s.className="bg-cyan hover:bg-light-cyan text-white font-bold block w-full sm:w-32 py-2 rounded-md disabled:bg-dark-violet transition-colors",s.onclick=h=>this.copy(h,e.short),i.appendChild(s);const d=document.createElement("button");return d.setAttribute("aria-label","Delete"),d.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true">
        <path d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0z"/>
      </svg>
      <span class="sr-only">Delete</span>
    `,d.className="bg-red fill-white hover:bg-opacity-80 font-bold block px-3 py-2 rounded-md transition-colors",d.onclick=this.delete.bind(this),i.appendChild(d),n}async copy(e,n){const r=e.target;try{await navigator.clipboard.writeText(n),this.copyIndicator(r,!0)}catch{this.copyIndicator(r,!1)}}copyIndicator(e,n){e.disabled=!0,e.textContent=n?"Copied!":"Not copied!",setTimeout(()=>{e.textContent="Copy",e.disabled=!1},1e3)}delete(e){const r=e.target.closest(".shortened-link"),i=r.dataset.id;i&&this.storage.removeShortenedLink(i),r.remove()}}const w=new L(new p("shortly-shorted-links"));w.init();
